;~function () {
    var app = function () {
        this.avatar = $('[data-selector="avatar"]');
        this.bindTel = $('[data-selector="bineTel"]');
        this.tel = $('[data-selector="tel"]');
        this.code = $('[data-selector="code"]');
    };
    app.prototype.init = function () {
        this.setAvatar();
        this.listener_bind_tel();
    };
    app.prototype.setAvatar = function () {
        var self = this;
        if(!api.pageParam.avatar) return false;
        self.avatar.css({
            'background-image' : 'url("'+ api.pageParam.avatar +'")'
        });
    };
    
    app.prototype.listener_bind_tel = function () {
        var self = this;
        self.bindTel.on('tap' , function () {
            self.telAjax();
        });
    };
    app.prototype.telAjax = function () {
        var self = this,
            $tel = self.tel.val(),
            $code = self.code.val();
        if(!api.pageParam.token) return $.api.toast('token出现错误');
        $.ajax({
            url : 'member/login/bindtel',
            data : {
                tel : $tel,
                code : $code,
                token : api.pageParam.token
            },
            success : function (ret) {
                $.api.toast('绑定成功');
                localStorage.access_token = ret.data.token;
                $.api.sendEvent('login',{});
                setTimeout(function () {
                    $.openWin({
                        name : 'root'
                    });
                },500);
            },
            error : function (err) {
                $.api.toast(err);
            }
        });
    };
    return $.bindTel = function () {
        return new app();
    };
}();